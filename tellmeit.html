<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Tell Me It - Slot</title>
<style>
  :root { --slot-size:80px; --slot-gap:12px; }
  html,body { height:100%; margin:0; background:#000; display:flex; align-items:center; justify-content:center; font-family:"Comic Sans MS", cursive, sans-serif; color:white; }
  .wrapper { text-align:center; max-width:900px; width:100%; }
  h1 { margin-bottom:18px; color:#ff7; text-shadow:0 0 12px rgba(255,200,0,0.6);}
  .slots { display:flex; justify-content:center; gap:var(--slot-gap); margin-bottom:18px; }
  .slot { 
    width:var(--slot-size); 
    height: calc(var(--slot-size) * 1.2); 
    background:#222; 
    border:3px solid #666; 
    border-radius:8px; 
    display:flex; 
    align-items:center; 
    justify-content:center; 
    font-size:34px; 
    font-weight:bold; 
    cursor:pointer; 
    user-select:none; 
    position:relative; 
    overflow:hidden; 
    box-shadow: 0 6px 24px rgba(0,0,0,0.6), inset 0 -6px 12px rgba(0,0,0,0.4); 
  }
  .slot span { 
    position:absolute; 
    width:100%; 
    display:flex;
    justify-content:center; 
    align-items:center; 
    transition: all 0.3s ease; 
    top:0; 
    left:0; 
  }
  .overlay { position:fixed; inset:0; background:#000; opacity:0; transition:opacity 1s ease; pointer-events:none; z-index:30; }
  #doorgate { position:fixed; left:50%; top:50%; transform:translate(-50%,-50%); width:360px; opacity:0; pointer-events:none; transition:opacity 1.2s ease; z-index:40; }
</style>
</head>
<body>
<div class="wrapper">
  <h1>Do you remember our secret code?</h1>
  <div class="slots" id="slotsContainer"></div>
</div>

<img id="doorgate" src="doorgate.png" alt="Door Gate">
<div class="overlay" id="overlay"></div>

<audio id="slotSound" src="slot.ogg"></audio>
<audio id="successSound" src="success.ogg"></audio>

<script>
const CODE = "GHALER";
const SLOTS = 6;
const letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
const slotsContainer = document.getElementById('slotsContainer');
const overlay = document.getElementById('overlay');
const doorgate = document.getElementById('doorgate');
const slotSound = document.getElementById('slotSound');
const successSound = document.getElementById('successSound');

const slotElems = [];
const slotValues = Array(SLOTS).fill('-');

for(let i=0;i<SLOTS;i++){
  const el = document.createElement('div');
  el.className='slot';
  
  const span = document.createElement('span');
  span.textContent = '-';
  el.appendChild(span);

  el.dataset.index=i;
  el.dataset.locked = "false"; // trava durante animação
  slotsContainer.appendChild(el);
  slotElems.push({el, span, value:'-'});

  el.addEventListener('click', ()=>{
    if(el.dataset.locked === "true") return; // impede cliques rápidos
    el.dataset.locked = "true";

    // tocar som curto
    slotSound.currentTime=0;
    slotSound.play().catch(()=>{});
    setTimeout(()=>{ slotSound.pause(); slotSound.currentTime=0; }, 150);

    // calcular próxima letra em ordem alfabética
    let current = slotElems[i].value;
    let nextIndex = letters.indexOf(current) + 1;
    if(nextIndex >= letters.length) nextIndex = 0;
    let nextLetter = letters[nextIndex];

    // animação estilo slot
    const oldSpan = slotElems[i].span;
    const newSpan = document.createElement('span');
    newSpan.textContent = nextLetter;
    newSpan.style.top = '-100%';
    newSpan.style.filter = 'blur(4px)';
    el.appendChild(newSpan);

    // oldSpan desce com blur
    oldSpan.style.transition = 'all 0.3s ease';
    oldSpan.style.top = '100%';
    oldSpan.style.filter = 'blur(4px)';

    // newSpan sobe
    setTimeout(()=> {
      newSpan.style.top = '0';
      newSpan.style.filter = 'blur(0px)';
    }, 10);

    // após animação
    setTimeout(()=> {
      el.removeChild(oldSpan);
      slotElems[i].span = newSpan;
      slotElems[i].value = nextLetter;
      slotValues[i] = nextLetter;
      el.dataset.locked = "false"; // desbloqueia slot
      checkCode();
    }, 310);
  });
}

function checkCode(){
  if(slotValues.includes('-')) return;
  const guess = slotValues.join('');
  if(guess===CODE){
    overlay.style.pointerEvents='auto';
    overlay.style.opacity=1;
    successSound.currentTime=0;
    successSound.play().catch(()=>{});
    setTimeout(()=>{doorgate.style.opacity=1;},1000);
  }
}
</script>
</body>
</html>
