import random
import numpy as np
import soundfile as sf
from pydub import AudioSegment, effects
from tortoise.api import TextToSpeech

tts = TextToSpeech()

text = input("Enter text: ")

voice = tts.tts(text)
sf.write("raw.wav", voice.squeeze(), 24000)

audio = AudioSegment.from_wav("raw.wav")

def explode(seg):
    noise = AudioSegment.generate_white_noise(duration=120).apply_gain(15)
    return seg.overlay(noise)

for i in range(8):
    audio = audio.low_pass_filter(random.randint(150,400))
    audio = audio.high_pass_filter(random.randint(100,600))
    audio = effects.speedup(audio, playback_speed=random.uniform(0.4,1.4))
    audio = audio + random.randint(-6,12)
    if random.random() < 0.4:
        audio = explode(audio)

audio.export("FINAL_INSANE.wav", format="wav")
print("Saved as FINAL_INSANE.wav")
